
user  wangyan;
worker_processes  auto;

#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

#pid        logs/nginx.pid;


events {
    worker_connections  1024;
}

# load modules compiled as Dynamic Shared Object (DSO)
#
dso {
    load ngx_http_fastcgi_module.so;
    load ngx_http_rewrite_module.so;
    load ngx_http_geoip_module.so;
    load ngx_http_access_module.so;
    load ngx_http_autoindex_module.so;
    load ngx_http_map_module.so;
    load ngx_http_charset_filter_module.so;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  logs/access.log  main;

    sendfile        on;
    #tcp_nopush     on;

    #keepalive_timeout  0;
    keepalive_timeout  65;

    #gzip  on;
    gzip on;
gzip_disable "msie6";

gzip_comp_level 6;
gzip_min_length 1100;
gzip_buffers 16 8k;
gzip_proxied any;
gzip_types
    text/plain
    text/css
    text/js
    text/xml
    text/javascript
    application/javascript
    application/x-javascript
    application/json
    application/xml
    application/xml+rss
    image/svg+xml;
gzip_vary on;
    #根据国家地区设置域名前缀
    geoip_country /usr/local/nginx/GeoIP.dat;
    geoip_proxy_recursive on;

   # 根据域名前缀配置指定的环境变量
    map $http_host $MAGE_RUN_CODE {
    	www.wangyonglin.com base;
    	cn.wangyonglin.com cn;
	}
    include ./vhosts/magento2.conf;
   
}
